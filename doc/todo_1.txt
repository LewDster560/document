6.11
******************************************************************************
融资项目
-------角色梳理-------
立项阶段
	创建项目---创建人
	项目审批---项目部副总
	业务洽谈---市场经理
	确定方案---市场经理
			项目立项---？？？？
	发起立项---项目经理
	立项审批---项目部副总
			协议审核---？？？？
	上传协议---市场经理
	协议审核---法务经理
	签署协议---市场经理
资金对接
	启动资金方对接---项目经理
	推荐资金方---市场经理
	金融产品设计---市场经理
	金融产品审核---项目部副总
	资产方审核放款---项目经理
	收取融资服务费---项目经理
结项阶段


-------提交表单-------融资项目10个

立项阶段
	1.创建项目
	2.项目审批
	
	3.更新进度日志
	4.完成洽谈
	
	5.立项申请
	6.立项审批
	7.上传协议
	8.签署协议
资金对接
	9.启动资金对接
	10.确认收费
******************************************************************************
平台项目
商务阶段同上

实施阶段
	产品技术启动会---项目经理
	产品设计---
	UI设计---
	技术开发---
	系统测试---
	环境部署---
	产品验收---
	发布上线---

运营阶段
	运营筹备启动---项目经理
	制定业务管理办法---
	平台培训---
	运营推广---
	技术支持---
金融产品运营阶段
	启动金融产品筹备---
	资产对接---
	金融产品设计---
	金融产品审核---
	产品对接平台---
	金融产品上线---
持续运营阶段
	发起任务---
	任务安排---
结项阶段
	项目结项---
	
******************************************************************************
项目状态
未启动（需求）
启动
关闭


******************************************************************************
持续运营阶段

开关
是否开启





******************************************************************************
pms_project_file
加字段
类型
合同
传文件的地方---类型
梳理有哪些地方


pms_core_project_template
project_type --删

pms_project_stage_info

pms_project_stage_template
`stage_type` varchar(2) DEFAULT NULL COMMENT '阶段类型',
删

  

pms_project_stage_template
中无阶段用户名


甘特 中 存创建任务ID？


pms_stage_process_info
角色
用户
流程类型
Update_date


pms_stage_process_template

流程类型



pms_process_task_info
task_type
5
提交
审批(gantt->100%)
投票
发起
启动

gantt => process_id

评审 A-B-A-B-C
	 1-2-3-4-5
	 
	 process=>taskTemplates(orderby).findIndex(currentTaskTemplateId) -> index+1 -> nextTaskTemplate
																				 -> none => parentProcess: parentStage.find
	 
	 
	 //taskTemplate.nextTaskTemplateId
	 
task1->task2

task(提交/审批) => process:state -> find(gantt?) gantt: 100%

技术实施启动 启动会 启动评审（+gantt）

发起（gantt） - 投票 - 审批XV
task                    task

gantts[].filter(gantt=>gantt.state===normal&&stage_id===id).length > 0 view
gantts.filter

gantts: project_id stage_id process_id process_name controller date

task.process_id.stage_id

gantts.filter(gantt=>gantt.stage_id === stage_id && gantt.state == init) -> normal || 废弃

[
	{
		fk_process_id: 
	}
]





gantt - state normal init 废弃






pms_process_task_info
ext_val rule
执行人

pms_process_task_template

Template: 结构 -> 模板 || project -> stage -> process -> task
Engine: 调度(启动创建) -> 分发 -> 处理(interface) -> 调度  || task

Gantt Meeting 



初始化状态

======================================================================
export default {
    project: {
        project_state: {
            init: '0', //待启动
            close: '2', //已关闭
            normal: '1', //运行中
            finish: '3', //已结项
        },
        menu_type: {
            platforms: {
                name: '平台项目',
                detail: '项目详情',
                list_type: {
                    all: '全部平台项目',
                    setup: '项目立项阶段',
                    implement: '技术实施阶段',
                    prepare: '项目运营筹备',
                    product: '金融产品筹备',
                    operate: '持续运营阶段',
                    finish: '项目结项阶段',
                }
            },
            finances: {
                name: '融资项目',
                detail: '项目详情',
                list_type: {
                    all: '全部融资项目',
                    setup: '项目立项阶段',
                    docking: '技术实施阶段',
                    finish: '项目结项阶段',
                }
            },
            demands: {
                name: '需求资源',
                detail: '需求详情',
            }
        }
    },
    stage: {
        stage_state: {
            init: '0', //待启动
            normal: '1', //运行中
            finish: '2', //已完成
        }
    },
    flow: {
        flow_state: {
            none: "0", //未创建
            normal: '1', //运行中
            finish: '2', //已完成
        },
        type: {
            A: '0',//A提交
            AB: '01',//A提交B审批
            DCB: '321',//D发起C投票B审批
            ECB: '425',//E启动C投票B审批
        }
    },
    task: {
        task_state: {
            normal: '0',//运行中
            finish: '1',//已完成
            deprecated: '2',//已弃用
            none: '3',//未创建
        },
        type: {
            A: {code: '0', name: '提交'},//A:只有ext表单提交
            B: {code: '1', name: '审批'},//B:审批，包括ext表单、审批
            C: {code: '2', name: '投票'},//C:投票，包括ext表单、投票
            D: {code: '3', name: '发起'},//D:发起，包括ext表单、投票人员选择
            E: {code: '4', name: '启动'},//E:启动，包括ext表单、甘特人员选择、投票人员选择
            F: {code: '5', name: '审批'},//F:审批，针对'启动'-> 对甘特处理
        }
    }
}
================================================================================================================
	
task A {} b{}

task_id 



A {foo: '',bee: ''}

A foo bee

A
GB
DCB
ECF


task:

validate -> switch ->type多态-> task_state: finish / 废弃 ->废弃: currentProcess>tasks:废弃-> firstTask : finish-> (nextTaskId? createNextTask : currentStageState-> finish )&& (isProcessEnd?(currentProcess:state->finish && finishGantt))



isProcessEnd => Process state

nextTaskId? => Stage state



================================================================================================================
	
const data = {
                detail: {
                    "id": "123123",
                    "project_number": "FTK01-201806190002",
                    "name": "Shnp Nkzlvp Gpgqrkr Wugyphb Yglwnb",
                    "project_type": "平台项目",
                    "customer_id": "2332431243423",
                    "customer_name": "xxxxx公司",
                    "type": "供应链项目",
                    "level": "紧急",
                    "project_state": "1",
                    "create_user": "Steven Hall",
                    "create_date": "2006-07-15 18:39:55",
                    "close_user": "Robert Clark",
                    "close_date": "1982-09-17 12:46:55",
                    "template_id": '123',
                    "ext_rule": "[]",
                    "ext_val": "{}",
                    "icon": 'cloud-o'
                },
                stages: [
                    {
                        "id": "s1",
                        "name": "项目立项阶段",
                        "stage_state": "1",
                        "sort": 0,
                        "current_flow_id": "s1f2",
                        "gantt": false
                    }, {
                        "id": "s2",
                        "name": "技术实施阶段",
                        "stage_state": "0",
                        "sort": 1,
                        "current_flow_id": "s2f1",
                        "gantt": true
                    }, {
                        "id": "s3",
                        "name": "项目运营筹备",
                        "stage_state": "0",
                        "sort": 2,
                        "current_flow_id": "s3f1",
                        "gantt": true
                    }, {
                        "id": "s4",
                        "name": "金融产品筹备",
                        "stage_state": "0",
                        "sort": 3,
                        "current_flow_id": "s4f1",
                        "gantt": true
                    }
                ],
                operations: [],
                gantts: [
                    {
                        "id": "320000201402193358",
                        "flow_name": "id non",
                        "controller": "eiusmod labore Excepteur laboris voluptate",
                        "plan_start_date": "ullamco ex qui reprehenderit",
                        "plan_end_date": "dolore et",
                        "start_date": "nostrud nulla non qui",
                        "end_date": "et pariatur",
                        "rate": "labore deserunt consequat",
                        "stage_id": "s3",
                        "sort": "laborum minim deserunt"
                    }
                ],
                diaries: [],
                flows: [
                    {
                        "id": "s1f1",
                        "name": "业务调研",
                        "stage_id": "s1",
                        "flow_state": "2", //0=未创建；1=进行中；2=已完成
                        "type": "0",//1=A提交；2=A申请B审批；3=A发起B投票C评审；4=A启动B投票C评审
                        "sort": 0,
                        "finish_date": '1981.01.01', //todo update_date
                        "current_task_id": "s1f1t1"
                    }, {
                        "id": "s1f2",
                        "name": "方案确定",
                        "stage_id": "s1",
                        "flow_state": "1",
                        "type": "1",
                        "sort": 1,
                        "current_task_id": "s1f2t1"
                    }, {
                        "id": "s1f3",
                        "name": "项目立项",
                        "stage_id": "s1",
                        "flow_state": "0",
                        "type": "3",
                        "sort": 2,
                        "current_task_id": ""
                    }, {
                        "id": "s1f4",
                        "name": "协议拟定",
                        "stage_id": "s1",
                        "flow_state": "0",
                        "type": "3",
                        "sort": 3,
                        "current_task_id": ""
                    }, {
                        "id": "s1f5",
                        "name": "协议签署",
                        "stage_id": "s1",
                        "flow_state": "0",
                        "type": "2",
                        "sort": 4,
                        "current_task_id": ""
                    }, {
                        "id": "s2f1",
                        "name": "技术实施启动",
                        "stage_id": "s2",
                        "flow_state": "1",
                        "type": "421",
                        "sort": 0,
                        "current_task_id": "s2f1t1"
                    }, {
                        "id": "s2f2",
                        "name": "产品设计",
                        "stage_id": "s2",
                        "flow_state": "0",
                        "type": "3",
                        "sort": 1,
                        "current_task_id": ""
                    }, {
                        "id": "s2f3",
                        "name": "UI设计",
                        "stage_id": "s2",
                        "flow_state": "0",
                        "type": "3",
                        "sort": 2,
                        "current_task_id": ""
                    }, {
                        "id": "s2f4",
                        "name": "技术开发", //提测报告
                        "stage_id": "s2",
                        "flow_state": "0",
                        "type": "2",
                        "sort": 3,
                        "current_task_id": ""
                    }, {
                        "id": "s2f5",
                        "name": "项目测试", //测试报告
                        "stage_id": "s2",
                        "flow_state": "0",
                        "type": "2",
                        "sort": 4,
                        "current_task_id": ""
                    }, {
                        "id": "s2f6",
                        "name": "生产部署", //部署申请
                        "stage_id": "s2",
                        "flow_state": "0",
                        "type": "2",
                        "sort": 5,
                        "current_task_id": ""
                    }, {
                        "id": "s2f7",
                        "name": "技术交付",
                        "stage_id": "s2",
                        "flow_state": "0",
                        "type": "2",
                        "sort": 6,
                        "current_task_id": ""
                    }, {
                        "id": "s3f1",
                        "name": "运营筹备启动",
                        "stage_id": "s3",
                        "flow_state": "1",
                        "type": "4",
                        "sort": 0,
                        "current_task_id": "s3f1t1"
                    }, {
                        "id": "s3f2",
                        "name": "制定业务管理办法",
                        "stage_id": "s3",
                        "flow_state": "0",
                        "type": "1",
                        "sort": 1,
                        "current_task_id": ""
                    }, {
                        "id": "s3f3",
                        "name": "平台培训",
                        "stage_id": "s3",
                        "flow_state": "0",
                        "type": "1",
                        "sort": 2,
                        "current_task_id": ""
                    }, {
                        "id": "s3f4",
                        "name": "运营推广",
                        "stage_id": "s3",
                        "flow_state": "0",
                        "type": "1",
                        "sort": 3,
                        "current_task_id": ""
                    }, {
                        "id": "s3f5",
                        "name": "技术支持",
                        "stage_id": "s3",
                        "flow_state": "0",
                        "type": "1",
                        "sort": 4,
                        "current_task_id": ""
                    }, {
                        "id": "s4f1",
                        "name": "金融产品筹备启动",
                        "stage_id": "s4",
                        "flow_state": "1",
                        "type": "4",
                        "sort": 0,
                        "current_task_id": "s4f1t1"
                    }, {
                        "id": "s4f2",
                        "name": "资产对接",
                        "stage_id": "s4",
                        "flow_state": "0",
                        "type": "1",
                        "sort": 1,
                        "current_task_id": ""
                    }, {
                        "id": "s4f3",
                        "name": "金融产品设计",
                        "stage_id": "s4",
                        "flow_state": "0",
                        "type": "3",
                        "sort": 2,
                        "current_task_id": ""
                    }, {
                        "id": "s4f4",
                        "name": "平台对接",
                        "stage_id": "s4",
                        "flow_state": "0",
                        "type": "1",
                        "sort": 3,
                        "current_task_id": ""
                    }, {
                        "id": "s4f5",
                        "name": "产品首次上线",
                        "stage_id": "s4",
                        "flow_state": "0",
                        "type": "2",
                        "sort": 4,
                        "current_task_id": ""
                    }
                ],
                tasks: [
                    {
                        "id": "s1f1t1",
                        "naxme": "业务调研提交",
                        "task_state": "1",//0=执行中；1=已完成；2=废弃
                        "type": "1",//1A提交
                        "flow_id": "s1f1",
                        "ext_val": "{}",
                        "ext_rule": "[]",
                        controller: '李狗蛋',
                        work_user: '',
                        finish_user: ''
                    }, {
                        "id": "s1f2t1",
                        "name": "方案确定提交",
                        "task_state": "0",//0=执行中；1=已完成
                        "type": "1",//1A提交
                        "flow_id": "s1f2",
                        "ext_val": "{}",
                        "ext_rule": "[]",
                        controller: '赵铁柱'
                    }, {
                        "id": "s2f1t1",
                        "name": "实施启动",
                        "task_state": "0",//0=执行中；1=已完成
                        "type": "4",//4A启动
                        "flow_id": "s2f1",
                        "ext_val": "{}",
                        "ext_rule": "[]",
                        controller: '马建国'
                    }, {
                        "id": "s3f1t1",
                        "name": "实施启动",
                        "task_state": "0",//0=执行中；1=已完成
                        "type": "4",//4A启动
                        "flow_id": "s3f1",
                        "ext_val": "{}",
                        "ext_rule": "[]",
                        controller: '诸葛建国'
                    }, {
                        "id": "s4f1t1",
                        "name": "实施启动",
                        "task_state": "0",//0=执行中；1=已完成
                        "type": "4",//4A启动
                        "flow_id": "s4f1",
                        "ext_val": "{}",
                        "ext_rule": "[]",
                        controller: '赵日天'
                    }
                ],
                contacts: [],
                meetings: [],
                logs: []
            };
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	const files;
	
	['1','2','3','4'].map(item=>files.find(file=>file.id === item))
	
	
	
	
	['1','2','4','11']
	
	
	
	
	
============================================OK

投票
查出任务ID，流程ID
	
	
	
============================================
node java rpc
============================================OK
如果有下一条，建下一条-没有的话修改流程状态
如果是流程的结尾->
============================================OK
启动user
============================================OK
持续运营加字段（是否有持续运营）
============================================OK
启动时候
分配权限
提交上来一个k-v k-角色  v-user
存到pms_project_role_info中 项目ID-角色-用户
============================================OK
启动写
Level
============================================
如何处理启动时角色与客户经理
============================================OK
rule移过去
============================================OK
创建时-不传文件
============================================OK
updateByPrimaryKey
============================================OK
审批通过

7.10
============================================OK
项目管理系统开发-处理任务(任务启动、投票处理)
============================================OK
投票
投票发起
============================================OK
投票全部完毕-->创建下一条
============================================
审批不通过-->甘特，投票全部取消
============================================OK
投票表 加 项目ID
============================================OK
如果是投票的任务->该任务下的投票->state全部变成1已投票--再创建
============================================
7.12
============================================
处理任务
============================================OK
检查启动权限-后台校验权限
============================================OK
投票info加流程ID
============================================OK
流程TYPE加入

7.16
============================================OK
审批拒绝-->废弃该阶段下所有的gantt
============================================
window.dev('http://192.168.9.246:8091');
============================================OK
启动权限校验
============================================OK
何时装gantt改为百分百
============================================
作图
============================================
消息类型0
需求
项目
投票
会议
登录

============================================
需要哪些内容
创建人
发送人
时间                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
内容
============================================
哪里触发消息

项目相关--
	需求录入
	需求关闭
	项目启动
		发送给-角色分配每个责任人
	项目关闭
阶段相关--
	阶段完成-
流程相关--
	流程完成-
任务相关--
	任务完成-
	下一步任务-
	驳回-
	通过-
甘特相关--
	启动后-通知负责人
投票相关--
	发起投票后-通知投票人
会议相关--

登录相关--
============================================
消息表
id
消息类型
消息内容
发送人
接收人
创建时间
更新时间
状态
============================================
类型
需求
项目
任务
甘特
会议
f4b411e4a4b50445e42616d73
============================================
7.30
项目编号规则
审批时更换项目名称
============================================
8.6
============================================
全局消息提醒
消息处理流程图

============================================↓OK
创建需求--市场部、项目部
8
12
18
角色更改后，旧的角色不能查看
============================================↓OK
平台编号规则
平台项目-FTKR+年月日+01
融资项目-FTKD+年月日+01
============================================
账户信息两张表
开户信息
费用
============================================
项目模板中加入 有没有费用字段
============================================
8.13
账户信息
费用


当前创建人 
 
市场部
的角色
扔进去

项目管理系统

平台编号规则修改
建表账户信息
建表费用信息
创建需求
项目模板表修改

上传附件






驳回删除
服务费信息



============================================
建立融资项目模板
新增任务类型处理流程
新增银行账户信息
新增首页所需接口

资产金额	单位 问人
============================================	
首页工作台快捷入口接口
首页工作台任务提醒接口
数据库优化学习

9.10
============================================
我的待办-该当前用户处理的所有任务（包括投票）--分页
我的申请-当前用户发起的 有审批的，未完成--分页
	流程里面-未完成的process_state=1/有审批的，process_type里有1的，
	查下面的第一个任务，第一个是我的
============================================
项目模板ID
项目ID
阶段ID
流程ID
============================================
0需求: 需求id:							OK
1项目id 模版id:							OK	
2模版id 项目id 流程id 任务id:			OK
3模版id 项目id 阶段id					OK
4会议id									OK
============================================
周报






BUG修改
docker部署应用
数据库优化总结
设计模式总结







集群 分布式 微服务 区别
均衡负载策略
微服务划分原则



项目管理系统--

项目管理系统--新增内部联系人
项目管理系统--新增外部联系人
项目管理系统--项目详情加入内外部联系人
项目管理系统--修改项目模板






wget http://mirror.bit.edu.cn/apache/maven/maven-3/3.5.3/binaries/apache-maven-3.5.3-bin.tar.gz


	
	
	
	
	
	
	
	
	
	
	
	
10.24
41接口
	
	
	
fbss_am_表名  账户中心管理系统
fbss_ci_表名  客户接口管理系统
fbss_ls_表名  业务日志管理系统
fbss_sa_表名  证书签章管理系统
fbss_sso_表名 单点登陆系统
fbss_cm_表名  系统公共表
	
	
	
	
	
	
	
	
	
	
	
	
10.26
有租户ID，就查该租户
无ID，查所有
	
	
	
账户中心管理系统-暴露接口结构编写
账户中心管理系统-中金第三方包上传
账户中心管理系统-熟悉中金文档概念
账户中心管理系统-熟悉中金开发流程
账户中心管理系统-测试接口测试


10.29
dao
	T1001


service


web
11.6
回推
项目管理系统-加入创建时间、排序
项目管理系统-增加消息已读接口
项目管理系统-增加我的待办新功能
项目管理系统-增加我的申请新功能

支撑平台-建立请求返回表结构
支撑平台-编写测试回推接口




支撑平台-完善校验
支撑平台-完善返回数据
支撑平台-请求返回入库


11.7
建表





待确认
待投票






实体类继承关系










基础（没必要）
msghd_ptncd	合作方编号		8
msghd_trcd	交易码			5

公共字段
msghd_trdt	交易日期 YYYYMMDD	8
msghd_trtm	交易时间 HH24MISS	6
msghd_bkcd	托管方编号			8
srl_ptnsrl	合作方交易流水号	32



返回
公共字段
msghd_rspcode	返回码	6
msghd_rspmsg	返回信息	200
srl_ptnsrl		合作方交易流水号	32
srl_platsrl		平台交易流水号		32




通知类的
T1035/T2008/T2020

返回response
T1008/T2009/2014/2019/9001/9002
没有的
2004






11.12
服务器rabbitmq




消息修改
驳回发送消息

没修改完
withdrawT1
withdrawT0


项目管理系统-修改审批通过驳回的消息内容
项目管理系统-修改一般任务通知的消息内容



支持平台-编写所有请求的校验
支持平台-建数据库表
====================================================================================================================================================================================================================================
11.19
七张表

账户表
结算账户表
资金明细表

订单划转表
解冻冻结表
充值表
提现表


T2020出金时间确定出金了吗

查询电子凭证数据要不要保留
出金额度问题
查询账户查谁


==================================================================
账户表
ID
客户号
资金账号
户名
客户性质
法定代表人/自然人-姓名
法定代表人/自然人-证件类型
法定代表人/自然人-证件号
统一社会信用代码
组织机构代码证
营业执照
税务登记号
手机
电子邮箱
邮政编码
客户地址
账户类型
==================================================================
结算账户表
ID

银行编号
银行账号(卡号)
开户名称
账户类别
银行账户(卡)类型
开户证件类型
证件号码
银行预留手机号码
跨行标示
开户网点编号
开户网点名称
开户网点省份编号
开户网点省份名称
开户网点城市编号
开户网点城市名称


关联-账户




==================================================================





































	
	
	
	
	
	
	
	
	
	
	
	
	